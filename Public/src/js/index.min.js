var rankImgPath="Public/src/images/rank/",clockImgPath="Public/src/images/clock/",sliderImgPath="Public/src/images/slider/",random,randomArray=[],game=function(){var e,n,t,a,i=$(".pic-container"),o=function(e,n){e&&n?d(n):layout.indexViewShow(e),layout.sliderContainerFix(),layout.sliderRandomSort(),clock.start()},r=function(n,t){o(n,t),i.on("click",".one-pic",function(){layout.sliderSelect(this);var n=$(this).find("img").data("index");void 0===e||e===n?e===n?c(n,!0):c(n):s(e,n)?d():e=void 0})},d=function(n){if(t=clock.stop(),$.each($(".one-pic"),function(e,n){$(n).removeClass("selectedSlider").addClass("unselectSlider")}),t&&(randomArray=[],e=void 0,i.off("click",".one-pic")),!n){var a={spendTime:t,openid:$("html").data("openid")};util.getRankInfo("index.php?s=/Home/Index/getRank",a,function(e){200===e.status?layout.resultViewShow(t,e.data):alert("你的网络有问题, 刚刚的成绩未生效!")})}},s=function(e,n){return $(".one-pic").eq(n).find("img").attr({src:sliderImgPath+randomArray[e]+".png"}).parent().removeClass("selectedSlider").addClass("unselectSlider"),$(".one-pic").eq(e).find("img").attr({src:sliderImgPath+randomArray[n]+".png"}).parent().addClass("unselectSlider").removeClass("selectedSlider"),a=randomArray[e],randomArray[e]=randomArray[n],randomArray[n]=a,a=void 0,l(randomArray)?!0:!1},c=function(n,t){e=t?void 0:n},l=function(e){n=0;for(var t=0;t<=e.length-1;t++)if(e[t]-t!=1){n++;break}return n>0?!1:!0};return{play:r}}(),layout=function(){var e,n,t,a,i,o=$("#start"),r=$("#index"),d=$("#result"),s={top:80/1136,bottom:79/1136,left:.2125,right:63/640},c=$(".one-pic"),l=function(e){$(e).removeClass("unselectSlider"),$(e).hasClass("selectedSlider")?($(e).addClass("unselectSlider").removeClass("selectedSlider"),setTimeout(function(){$(e).removeClass("unselectSlider")},200)):$(e).addClass("selectedSlider")},u=function(){$(".pic-container").css({height:100*(1-s.top-s.bottom)+"%",width:100*(1-s.left-s.right)+"%",position:"absolute",top:100*s.top+"%",left:100*s.left+"%"})},m=function(){$(".one-pic").css({"float":"left",height:$(".pic-container").height()/4,width:($(".pic-container").width()-1)/3}),$.each(c,function(e,n){$(n).find("img").attr({src:sliderImgPath+util.randomGenerate()+".png"}).data("index",e)})},f=function(e){e?(r.css("display","block").removeClass("flipOutX").addClass("bounceInRight"),d.removeClass("flipInX").addClass("bounceOutLeft").css("display","none")):(o.addClass("animated bounceOutDown").css("display","none"),r.css("display","block").addClass("animated bounceInDown"))},h=function(e,n){r.removeClass("bounceInDown").addClass("flipOutX").css("display","none"),a(n),i(e),d.css("display","block").addClass("animated flipInX")};return a=function(e){n=$(".rank-info img");for(var t=e.length-1;t>=0;t--)n.eq(t).attr("src",rankImgPath+e[t]+".png").css("display","block")},i=function(n){e=60*(10*n.kilobit+n.hundreds)+10*n.decade+n.theUnit,e=String(e).split("").reverse().join(""),t=$(".spend-time img");for(var a=e.length-1;a>=0;a--)t.eq(a).attr("src",rankImgPath+e[a]+".png").css("display","block")},{sliderSelect:l,indexViewShow:f,resultViewShow:h,sliderRandomSort:m,sliderContainerFix:u}}(),clock=function(){var e,n={theUnit:0,decade:0,hundreds:0,kilobit:0},t=$(".time-counter-container"),a=function(){o(),e=setInterval(function(){9===n.theUnit?(n.theUnit=0,r(0),5===n.decade?(n.decade=0,r(1),9===n.hundreds?(n.hundreds=0,r(3),5===n.kilobit?(r(4,6),i(!0)):r(4,++n.kilobit)):r(3,++n.hundreds)):r(1,++n.decade)):r(0,++n.theUnit)},1001)},i=function(t){return clearInterval(e),tempClockHand=n,n={theUnit:0,decade:0,hundreds:0,kilobit:0},t&&(alert("时间到了!"),location.reload()),tempClockHand},o=function(){t.css({display:"block"}).addClass("animated shake").removeClass("animated shake"),$.each(t.find("img"),function(e,n){2!=e&&$(n).attr("src",clockImgPath+"0.png")})},r=function(e,n){n=n?n:0,t.find("img").eq(e).attr({src:clockImgPath+n+".png"}).addClass("animated fadeInLeft")};return{start:a,stop:i}}(),util=function(){var e=function(){return random=Math.floor(12*Math.random()+1),-1==$.inArray(random,randomArray)?(randomArray.push(random),random):e()},n=function(e,n,t){$.ajax({url:e,type:"POST",data:n,dataType:"json",success:t,error:function(e,n){alert("网络错误, 请重试!")}})},t=function(e,n){document.cookie=e+"="+escape(n)},a=function(e){return document.cookie.length>0?(start=document.cookie.indexOf(e+"="),-1!=start?(start=start+e.length+1,end=document.cookie.indexOf(";",start),-1==end&&(end=document.cookie.length),unescape(document.cookie.substring(start,end))):void 0):void 0},i=function(e){var n=new Date;n.setTime(n.getTime()-1);var t=a(e);t&&(document.cookie=e+"="+t+";expires="+n.toGMTString())};return{setCookie:t,getCookie:a,delCookie:i,getRankInfo:n,randomGenerate:e}}();